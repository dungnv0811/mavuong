<h1>Schedule Your Appointment</h1>

<section class="card doc">
  <div class="hd">
    <img class="avatar" [src]="DEFAULT_AVATAR_MALE" alt="avatar" />
    <div>
      <div class="name">{{ doctor().name }}</div>
      <div class="sp">{{ doctor().specialty }}</div>
      <div class="rt">‚≠ê {{ doctor().rating }} <span class="muted">({{ doctor().reviews }} reviews)</span></div>
    </div>
    <button class="btn ghost" (click)="viewDoctorProfile()">View Profile</button>
  </div>
</section>

<section class="card" *ngIf="!isViewMode()">
  <h2>Select Date & Time</h2>
  <div class="datetime">
    <div class="date">
      <label>Choose a date</label>
      <input type="date" [value]="date()" (change)="pickDate($event)" />
    </div>
    <div class="times">
      <label>Available Time Slots</label>
      <div class="slot-grid">
        <button class="slot"
                [class.active]="chosenSlot()===slot.time"
                [class.booked]="slot.isBooked"
                [class.disabled]="slot.isDisabled"
                [disabled]="slot.isBooked || slot.isDisabled"
                *ngFor="let slot of slots()"
                (click)="pickSlot(slot.time)">
          {{ slot.time }}
          <span *ngIf="slot.isBooked" class="status">Booked</span>
          <span *ngIf="slot.isDisabled && !slot.isBooked" class="status">Past</span>
        </button>
      </div>
    </div>
  </div>
</section>

<section class="card" *ngIf="isViewMode()">
  <h2>Appointment Details</h2>
  <div class="appointment-info">
    <p><strong>Date & Time:</strong> {{ date() }} at {{ chosenSlot() }}</p>
    <p><strong>Status:</strong> {{ viewingAppointment()?.status }}</p>
  </div>
</section>

<section class="card">
  <h2>Patient Information</h2>
  <form [formGroup]="form" (ngSubmit)="submit()">
    <div class="grid">
      <div class="field">
        <label>Full Name</label>
        <input formControlName="fullName" placeholder="John Doe" [readonly]="isViewMode()" />
      </div>
      <div class="field">
        <label>Email Address</label>
        <input type="email" formControlName="email" placeholder="john.doe@example.com" [readonly]="isViewMode()" />
      </div>
      <div class="field">
        <label>Phone Number</label>
        <input formControlName="phone" placeholder="+1 (555) 123-4567" [readonly]="isViewMode()" />
      </div>
      <div class="field">
        <label>Gender</label>
        <select formControlName="gender" [disabled]="isViewMode()">
          <option value="">Select gender</option>
          <option>Male</option>
          <option>Female</option>
          <option>Other</option>
        </select>
      </div>
      <div class="field full">
        <label>Reason for Visit</label>
        <textarea rows="4" formControlName="reason" placeholder="Briefly describe your symptoms or reason for the visit..." [readonly]="isViewMode()"></textarea>
      </div>
      <div class="field">
        <label>Insurance Provider (Optional)</label>
        <input formControlName="insurance" placeholder="e.g., Blue Cross Blue Shield" [readonly]="isViewMode()" />
      </div>
      <div class="field">
        <label>Policy Number (Optional)</label>
        <input formControlName="policyNumber" placeholder="XXXX-XXXX-XXXX" [readonly]="isViewMode()" />
      </div>
      <div class="field full chk">
        <label *ngIf="!isViewMode()"><input type="checkbox" formControlName="agree" /> I agree to the <a href="#">terms and conditions</a>.</label>
      </div>
    </div>

    <div class="actions" *ngIf="!isViewMode()">
      <button type="submit" class="btn primary" [disabled]="!canSubmit()">Confirm Booking</button>
    </div>
  </form>
</section>
